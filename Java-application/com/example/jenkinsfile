pipeline {
    agent none
    stages {
        stage('Build Java application') {
            agent {
                docker { image 'maven:3.8.1-adoptopenjdk-11' }
            }
            steps {
                // Change to the directory where the pom.xml is located
                dir('Java-application') {
                    // Build the Java application using Maven
                    sh 'mvn clean install'
                }
            }
        }
        stage('Run Java Application') {
            agent {
                docker { image 'openjdk:11' }
            }
            steps {
                // Change to the directory where the pom.xml is located
                dir('Java-application') {
                    // Run hello world
                    sh 'java -cp target/hello-world-1.0-SNAPSHOT.jar com.example.HelloWorld'
                }
            }
        }
    }
}
